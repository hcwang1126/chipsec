<?xml version="1.0"?>
<configuration platform="SKX" >
<!-- XML configuration file for Skylake/Purely Server
-->
<!--
***********************************************************

                   PRE-RELEASE NOTICE

        This file contains pre-release functionality
        Please do not distribute this file publicly

***********************************************************
-->

  <pci>
    <device name="_MISCCTRLSTS0_0.0.0" bus="0" dev="0x00" fun="0" vid="0x8086" />
    <device name="_MISCCTRLSTS0_1.0.0" bus="1" dev="0x00" fun="0" vid="0x8086" />
    <device name="_MISCCTRLSTS0_1.1.0" bus="1" dev="0x01" fun="0" vid="0x8086" />
    <device name="_MISCCTRLSTS0_1.2.0" bus="1" dev="0x02" fun="0" vid="0x8086" />
    <device name="_MISCCTRLSTS0_1.3.0" bus="1" dev="0x03" fun="0" vid="0x8086" />
    <device name="_SMB_CMD_CFG" bus="1" dev="0x1E" fun="0" vid="0x8086" />
    <device name="_CSR_DESIRED_CORES_CFG2" bus="1" dev="0x1E" fun="1" vid="0x8086" />
  </pci>

  <mmio>
    <bar name="MMCFG"  bus="0" dev="5"    fun="0" reg="0x90" width="8" mask="0x7FFFFFC000000" size="0x1000" desc="PCI Express Register Range"/>
    <bar name="DMIBAR" bus="0" dev="0"    fun="0" reg="0x50" width="4" mask="0xFFFFF000"      size="0x1000" enable_bit="0" desc="Root Complex Register Range"/>
    <bar name="SPIBAR" bus="0" dev="0x1F" fun="5" reg="0x10" width="4" mask="0xFFFFF000"      size="0x200"  desc="SPI Controller Register Range"/>
    <bar name="TCO_BAR" bus="0" dev="0x1F" fun="4" reg="0x50" width="4" mask="0xFFE0"          size="0x1000"  desc="TCO Base Register Register Range"/>
    <bar name="SBREGBAR" register="SBREG_BAR" base_field="RBA" size="0x1000000" desc="Sideband Register Access BAR"/>
  </mmio>

  <io>
    <bar name="TCOBAR" register="TCO_BAR" base_field="Base" size="0x80" desc="TCO Base Address"/>
  </io>

  <memory>
  </memory>

  <registers>
    <!-- Host Controller -->
    <register name="MISCCTRLSTS0_0.0.0" type="mmcfg" bus="0" dev="0" fun="0" offset="0x188" size="4" desc="MISC Control and Status Register 0">
      <field name="inbound_configuration_enable" bit="1" size="1" desc="Enable Inbound Configuration Requests"/>
    </register>
    <register name="MISCCTRLSTS0_1.0.0" type="mmcfg" bus="1" dev="0" fun="0" offset="0x188" size="4" desc="MISC Control and Status Register 0">
      <field name="inbound_configuration_enable" bit="1" size="1" desc="Enable Inbound Configuration Requests"/>
    </register>
    <register name="MISCCTRLSTS0_1.1.0" type="mmcfg" bus="1" dev="1" fun="0" offset="0x188" size="4" desc="MISC Control and Status Register 0">
      <field name="inbound_configuration_enable" bit="1" size="1" desc="Enable Inbound Configuration Requests"/>
    </register>
    <register name="MISCCTRLSTS0_1.2.0" type="mmcfg" bus="1" dev="2" fun="0" offset="0x188" size="4" desc="MISC Control and Status Register 0">
      <field name="inbound_configuration_enable" bit="1" size="1" desc="Enable Inbound Configuration Requests"/>
    </register>
    <register name="MISCCTRLSTS0_1.3.0" type="mmcfg" bus="1" dev="3" fun="0" offset="0x188" size="4" desc="MISC Control and Status Register 0">
      <field name="inbound_configuration_enable" bit="1" size="1" desc="Enable Inbound Configuration Requests"/>
    </register>
    
    <register name="TSEG" type="pcicfg" bus="0" dev="5" fun="0" offset="0xA8" size="8" desc="TSEG Memory">
      <field name="base"  bit="20" size="12" desc="Base address"/>
      <field name="limit" bit="52" size="12" desc="Limit address"/>
    </register>
    <register name="TSEG_BASE" type="pcicfg" bus="0" dev="5" fun="0" offset="0xA8" size="4" desc="TSEG Memory Base">
      <field name="base"  bit="20" size="12" desc="Base address"/>
    </register>
    <register name="TSEG_LIMIT" type="pcicfg" bus="0" dev="5" fun="0" offset="0xAC" size="4" desc="TSEG Memory Limit">
      <field name="limit" bit="20" size="12" desc="Limit address"/>
    </register>

    <register name="VTBAR" type="mmcfg" bus="0" dev="5" fun="0" offset="0x180" size="4" desc="VT BAR Register">
      <field name="vtd_chipset_base_address_enable" bit="0" size="1" desc="VTBAR enable"/>
    </register>
    <register name="VTGENCTRL" type="mmcfg" bus="0" dev="5" fun="0" offset="0x184" size="4" desc="VTGENCTRL Register">
      <field name="lockvtd" bit="15" size="1" desc="lockvtd"/>
    </register>
    

    <!-- GENPROTRANGE Registers -->   
    <register name="GENPROTRANGE1_BASE" type="mmcfg" bus="0" dev="5" fun="0" offset="0x210" size="8" desc="Generic Protected Memory Range 1 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 1 base address"/>
    </register>  
    <register name="GENPROTRANGE1_LIMIT" type="mmcfg" bus="0" dev="5" fun="0" offset="0x218" size="8" desc="Generic Protected Memory Range 1 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 1 limit address"/>
    </register>      
    <register name="GENPROTRANGE2_BASE" type="mmcfg" bus="0" dev="5" fun="0" offset="0x220" size="8" desc="Generic Protected Memory Range 2 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 2 base address"/>
    </register>      
    <register name="GENPROTRANGE2_LIMIT" type="mmcfg" bus="0" dev="5" fun="0" offset="0x228" size="8" desc="Generic Protected Memory Range 2 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 2 limit address"/>
    </register>       
    <register name="GENPROTRANGE0_BASE" type="mmcfg" bus="0" dev="5" fun="0" offset="0x200" size="8" desc="Generic Protected Memory Range 0 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 0 base address"/>
    </register>      
    <register name="GENPROTRANGE0_LIMIT" type="mmcfg" bus="0" dev="5" fun="0" offset="0x208" size="8" desc="Generic Protected Memory Range 0 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 0 limit address"/>
    </register>
    <register name="GENPROTRANGE3_BASE" type="mmcfg" bus="0" dev="5" fun="0" offset="0x230" size="8" desc="Generic Protected Memory Range 3 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 3 base address"/>
    </register>
    <register name="GENPROTRANGE3_LIMIT" type="mmcfg" bus="0" dev="5" fun="0" offset="0x238" size="8" desc="Generic Protected Memory Range 3 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 3 limit address"/>
    </register>
    <register name="GENPROTRANGE4_BASE" type="mmcfg" bus="0" dev="5" fun="0" offset="0x240" size="8" desc="Generic Protected Memory Range 4 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 4 base address"/>
    </register>
    <register name="GENPROTRANGE4_LIMIT" type="mmcfg" bus="0" dev="5" fun="0" offset="0x248" size="8" desc="Generic Protected Memory Range 4 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 4 limit address"/>
    </register>
    
    <register name="GEN_PMCON_B" type="pcicfg" bus="0" dev="0x1F" fun="2" offset="0xA4" size="4" desc="General Power Management Configuration Lock">
      <field name="ACPI_BASE_LOCK" bit="17" size="1" desc="Lock down ACPI Base Address (ABASE)"/>
    </register>
    
    <!-- SPSR PCIe Configuration Space -->
    <register name="SMB_CMD_CFG_0" type="pcicfg" bus="1" dev="0x1E" fun="5" offset="0x9C" size="4" desc="SMB_CMD_CFG_0 Register">
      <field name="smb_dis_wrt" bit="26" size="1" desc="Disable SMBus Write"/>
    </register>
    <register name="SMB_CMD_CFG_1" type="pcicfg" bus="1" dev="0x1E" fun="5" offset="0xA0" size="4" desc="SMB_CMD_CFG_1 Register">
      <field name="smb_dis_wrt" bit="26" size="1" desc="Disable SMBus Write"/>
    </register>
    <register name="SMB_CMD_CFG_2" type="pcicfg" bus="1" dev="0x1E" fun="5" offset="0xA4" size="4" desc="SMB_CMD_CFG_2 Register">
      <field name="smb_dis_wrt" bit="26" size="1" desc="Disable SMBus Write"/>
    </register>

    <!-- Power Control Unit (PCU) Registers -->
    <register name="CSR_DESIRED_CORES_CFG2" type="pcicfg" bus="1" dev="0x1E" fun="1" offset="0xA0" size="4" desc="Number of cores-threads to exhist">
      <field name="LOCK" bit="31" size="1" desc="Locks CSR_DESIRED_CORES register"/>
    </register>

    <!-- SPI Flash Controller MMIO registers -->
    <register name="SRDL" type="mmio" bar="SPIBAR" offset="0xF0" size="4" desc="Soft Reset Data Lock">
      <field name="SSL" bit="0" size="1" desc="Set_Stap Lock"/>
    </register>

    <!-- PCH ABASE (PMBASE) I/O registers -->
    <register name="ABASE" type="pcicfg" bus="0" dev="0x1F" fun="2" offset="0x40" size="4" desc="ACPI Base Address">
      <field  name="Base" bit="8" size="24" desc="Base Address"/>
    </register>
    
    <register name="TCO_BAR" type="pcicfg" bus="0" dev="0x1F" fun="4" offset="0x50" size="4" desc="TCO Base Address">
      <field  name="Base" bit="5" size="11" desc="Base Address"/>
    </register>   
    
    <register name="SMI_EN" type="iobar" bar="ABASE" offset="0x30" size="4" desc="SMI Control and Enable">
      <field name="GBL_SMI_EN"         bit="0"  size="1"/>
      <field name="TCO_EN"             bit="13" size="1"/>
      <field name="GPIO_UNLOCK_SMI_EN" bit="27" size="1"/>
    </register>
    <register name="TCO1_CNT" type="iobar" bar="TCOBAR" offset="0x8" size="2" desc="TCO1 Control">
      <field name="TCO_LOCK"           bit="12"  size="1"/>
    </register>
    <register name="GEN_PMCON_1" type="pcicfg" bus="0" dev="0x1f" fun="2" offset="0xA0" size="2" desc="General PM Configuration 1">
      <field name="SMI_LOCK"    bit="4"     size="1"/>
    </register>    
    
    <!-- SPI Interface Controller -->
    <register name="BC" type="pcicfg" bus="0" dev="0x1F" fun="5" offset="0xDC" size="4" desc="BIOS Control">
      <field name="BIOSWE"   bit="0" size="1" desc="BIOS Write Enable" /> <!-- WPD -->
      <field name="BLE"      bit="1" size="1" desc="BIOS Lock Enable" /> <!-- LE -->
      <field name="TSS"      bit="4" size="1" desc="Top Swap Status" /> <!-- TSS -->
      <field name="SMM_BWP"  bit="5" size="1" desc="SMM BIOS Write Protection" /> <!-- EISS -->
      <field name="BILD"     bit="7" size="1" desc="BIOS Interface Lock Down"/> <!-- BILD -->
    </register>
    
	  <!-- CPU Model Specific Registers -->
    <register name="MSR_PKG_CST_CONFIG_CONTROL" type="msr" msr="0xE2" desc="C-State Configuration Register">
      <field name="LOCK" bit="15"  size="1"  desc="Lock MSR_PKG_CST_CONFIG_CONTROL register" />
    </register>

	<!-- Sideband Register Access Registers -->
    <register name="SBREG_BAR" type="pcicfg" bus="0" dev="0x1F" fun="1" offset="0x10" size="4" desc="Sideband Register Access BAR">
      <field name="RBA" bit="24" size="8" desc="Register Base Address"/>
    </register>
    
    <register name="P2SBC" type="pcicfg" bus="0" dev="0x1F" fun="1" offset="0xE0" size="2" desc="P2SB Configuration Register">
      <field name="HIDE" bit="8" size="1" desc="Hide SBREG_BAR"/>
    </register>
	
	<!-- DCI registers -->
    <register name="ECTRL" type="mm_msgbus" port="0xB8" offset="0x0004" size="4" desc="DCI Control Register">
      <field name="LOCK" bit="0" size="1"/>
      <field name="ENABLE" bit="4" size="1"/>
      <field name="AVAILABLE" bit="8" size="1"/>
    </register>
    
  </registers>

  <controls>
    <control name="BiosInterfaceLockDown" register="BC" field="BILD" desc="BIOS Interface Lock-Down"/>
  </controls>
  
</configuration>
